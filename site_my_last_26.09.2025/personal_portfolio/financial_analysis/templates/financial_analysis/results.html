{% extends 'skills/base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞: {{ document.title }}</h2>
    <p class="text-muted">–¢–∏–ø: {{ document.get_document_type_display }}</p>

    {% if ratios %}
    <div class="card">
        <div class="card-header bg-success text-white">
            <h4>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã</h4>
        </div>
        <div class="card-body">
            <!-- –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ –≥–æ–¥–∞–º -->
            {% regroup ratios by year as year_list %}

            {% for year in year_list %}
            <h5>üìä {{ year.grouper }} –≥–æ–¥:</h5>
            <div class="row">
                {% for ratio in year.list %}
                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title">{{ ratio.ratio_name }}</h6>
                            <h4 class="text-primary">{{ ratio.ratio_value|floatformat:2 }}</h4>

                            <!-- –ê–Ω–∞–ª–∏–∑ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ -->
                            {% if '–ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏' in ratio.ratio_name %}
                                {% if ratio.ratio_value > 2 %}
                                    <small class="text-success">‚úÖ –û—Ç–ª–∏—á–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å</small>
                                {% elif ratio.ratio_value > 1 %}
                                    <small class="text-warning">‚ö†Ô∏è –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å</small>
                                {% else %}
                                    <small class="text-danger">‚ùå –ù–∏–∑–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å</small>
                                {% endif %}
                            {% endif %}

                            {% if '–∞–≤—Ç–æ–Ω–æ–º–∏–∏' in ratio.ratio_name %}
                                {% if ratio.ratio_value > 0.6 %}
                                    <small class="text-success">‚úÖ –í—ã—Å–æ–∫–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</small>
                                {% elif ratio.ratio_value > 0.4 %}
                                    <small class="text-warning">‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</small>
                                {% else %}
                                    <small class="text-danger">‚ùå –ù–∏–∑–∫–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</small>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <hr>
            {% endfor %}

            <!-- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ -->
            <div class="mt-4">
                <h5>üìà –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h5>
                <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–µ–∂–¥—É –ø–µ—Ä–∏–æ–¥–∞–º–∏...</p>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-warning">
        –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞.
        <br>
        <a href="{% url 'financial_debug' document.id %}" class="btn btn-warning btn-sm mt-2">
            üêõ –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
        </a>
    </div>
    {% endif %}

    <div class="mt-3">
        <a href="{% url 'financial_debug' document.id %}" class="btn btn-warning">
            üêõ –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
        </a>
        <a href="{% url 'financial_upload' %}" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥–æ–π –¥–æ–∫—É–º–µ–Ω—Ç</a>
        <a href="{% url 'financial_list' %}" class="btn btn-secondary">–ö —Å–ø–∏—Å–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</a>
    </div>
</div>
{% endblock %}